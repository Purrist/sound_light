<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>音乐生成器</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="generator.css"> 
</head>
<body>
    <div class="generator-container">
        <!-- LEFT: Library Panel -->
        <aside class="library-panel">
            <div class="library-header">
                <a href="/index.html" class="back-button">❮ 返回</a>
                <h2>音源库</h2>
            </div>
            <div class="library-content">
                <div class="library-section">
                    <h3>主轨音频</h3>
                    <ul id="mainAudioList" class="preset-list audio-list"></ul>
                </div>
                <div class="library-section">
                    <h3>辅轨音频</h3>
                    <ul id="auxAudioList" class="preset-list audio-list"></ul>
                </div>
                <div class="library-section">
                    <h3>混音素材</h3>
                    <ul id="mixElementsList" class="preset-list audio-list"></ul>
                </div>
            </div>
        </aside>
        <!-- RIGHT: Main Panel -->
        <main class="generator-main">
            <!-- Top Right: Creation Panel -->
            <div class="creation-panel">
                <div class="tabs">
                    <button class="tab-button active" data-tab="main-track-generator">生成主轨音频</button>
                    <button class="tab-button" data-tab="aux-track-generator">生成辅轨音频</button>
                </div>
                <!-- Main Track Generator Tab Content -->
                <div id="main-track-generator" class="tab-content active">
                    <h4>参数设置 (粉红噪音)</h4>
                    <div class="param-grid">
                        <label>时长 (秒):</label>
                        <input type="number" id="noiseDuration" value="10" min="1" max="60">
                        
                        <label for="toneSlider">音色 (截止频率):</label>
                        <div class="slider-container">
                            <span>沉闷 (500Hz)</span>
                            <input type="range" id="toneSlider" min="500" max="15000" value="8000" class="param-slider">
                            <span>明亮 (15kHz)</span>
                        </div>

                        <label for="resonanceSlider">共振 (Q值):</label>
                         <div class="slider-container">
                            <span>平滑</span>
                            <input type="range" id="resonanceSlider" min="0.7" max="10" value="1" step="0.1" class="param-slider">
                            <span>尖锐</span>
                        </div>

                        <label for="widthSlider">声音宽度:</label>
                         <div class="slider-container">
                            <span>集中</span>
                            <input type="range" id="widthSlider" min="0" max="1" value="0.8" step="0.05" class="param-slider">
                            <span>宽广</span>
                        </div>
                    </div>
                    <button id="generateMainBtn" class="generate-button">生成</button>
                </div>
                <!-- Aux Track Generator Tab Content -->
                <div id="aux-track-generator" class="tab-content">
                    <h4>混音层编辑器 (即将推出)</h4>
                </div>
            </div>
            <!-- Bottom Right: Preview Panel -->
            <div class="preview-panel">
                <div id="preview-light-background"><div id="preview-guide-text">预览</div></div>
                <div class="preview-controls">
                    <button id="previewToggleBtn" disabled>▶ 预览</button>
                    <div id="previewInfo" class="preview-info">暂无音频可预览</div>
                    <label>呼吸频率: <input type="number" id="previewBPM" value="6"> 次/分</label>
                    <label>响度范围 (dB): <input type="number" id="previewMinVol" value="-40"> - <input type="number" id="previewMaxVol" value="-10"></label>
                    <button id="saveTrackBtn" disabled>💾 保存</button>
                </div>
            </div>
        </main>
    </div>
    <audio id="previewAudio" loop crossorigin="anonymous"></audio>
    <!-- We need the main script.js for auth status and other helpers -->
    <script src="common.js"></script>
    <script src="generator.js"></script>
</body>
</html>